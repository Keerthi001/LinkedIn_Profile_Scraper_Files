{"version":3,"file":"index.js","sources":["../../../../src/pages/config/index.ts","../../../../src/pages/store/storage/constants.ts","../../../../src/pages/background/background.service.ts","../../../../src/pages/background/index.ts"],"sourcesContent":["export const mainDomain = 'https://www.linkedin.com';\r\n\r\nexport const LINKED_LOGIN_CONFIG = {\r\n  LOGIN_URL: 'https://www.linkedin.com/oauth/v2/authorization?response_type=code',\r\n  APP_CLIENT_ID: '86h99ith096cfg',\r\n  REDIRECT_URL: 'linkedin_callback',\r\n  SCOPES: 'openid profile email r_basicprofile r_1st_connections_size',\r\n};\r\n\r\n// export const postAbaDomainUrl = 'https://postaba.com';\r\nexport const backendUrl = 'https://dev.postaba.com';\r\nexport const supportEmail = 'support@shinnedhawks.com';\r\n\r\nexport const newWindowName = 'search_profiles_scraping_window';","export const STORAGE_KEY = {\r\n  SCRAPPER_SECRET_CODE: 'linkedin-data-scrapper-secret-code',\r\n  CURRENT_PROFILE: 'current-profile',\r\n  SHOW_SCRAPABA: 'show-scrapaba',\r\n  CURRENT_PAGE: 'current-page',\r\n  TOTAL_NO_OF_PAGE: 'total-no-of-page'\r\n}\r\n\r\nexport const MESSAGE_NAME = {\r\n  SECRET_CODE_RECEIVED_FROM_COOKIE: 'SECRET_CODE_RECEIVED_FROM_COOKIE',\r\n  SET_SECRET_CODE_IN_COOKIE: 'SET_SECRET_CODE_IN_COOKIE',\r\n  GET_SECRET_CODE_FROM_COOKIE: 'GET_SECRET_CODE_FROM_COOKIE',\r\n  INSERT_SCRAPPER_PLUGIN: 'INSERT_SCRAPPER_PLUGIN',\r\n  LOGIN_WITH_LINKEDIN_REQUEST: 'LOGIN_WITH_LINKEDIN_REQUEST'\r\n}\r\n\r\nexport const defaultProfileDetails = {\r\n  \"name\": \"\",\r\n  \"title\": \"\",\r\n  \"talksAbout\": \"\",\r\n  \"location\": \"\",\r\n  \"about\": \"\",\r\n  \"url\": \"\",\r\n  \"experiences\": [],\r\n  \"skills\": [],\r\n  \"followers\": \"\",\r\n  \"connections\": \"\",\r\n  \"email\": \"\",\r\n  \"phone\": \"\",\r\n  \"birthDate\": \"\"\r\n}\r\n\r\nexport const containerId = 'posts-export-container';\r\n\r\nconst setItem = (name: string, value: any) => {\r\n  localStorage.setItem(name, value);\r\n}\r\n\r\nconst getItem = (name: string) => {\r\n  return localStorage.getItem(name);\r\n}\r\n\r\nexport const isScrapabaVisible = () => {\r\n  return getItem(STORAGE_KEY.SHOW_SCRAPABA) === 'true';\r\n}\r\n\r\nexport const setScrapabaVisibleOrNot = (value: boolean) => {\r\n  setItem(STORAGE_KEY.SHOW_SCRAPABA, value);\r\n  const existingContainer = document.getElementById(containerId);\r\n  if (existingContainer) {\r\n    existingContainer.className = `export-main-container ${value ? '' : 'close'}`;\r\n  }\r\n}","export const postData = async (url = \"\", code: string, redirect_url: string, data: any) => {\r\n  const response = await fetch(url, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      code: code,\r\n      rurl: redirect_url,\r\n      'product-code' : 'scraper'\r\n    },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return response.json();\r\n}","import { LINKED_LOGIN_CONFIG, backendUrl, mainDomain } from \"../config\";\r\nimport { Message } from \"../interface\";\r\nimport { MESSAGE_NAME, STORAGE_KEY } from \"../store/storage/constants\";\r\nimport { postData } from \"./background.service\";\r\n\r\nconst setCookie = (name: string, value: any, callback?: any) => {\r\n  chrome?.cookies?.set({ url: mainDomain, name: name, value: value }, callback);\r\n}\r\n\r\nconst postCookiesToContentScript = async () => {\r\n  await chrome.tabs.query({active: true, currentWindow: true}, (tabs: any) => {\r\n    const tab = tabs?.[0];\r\n    chrome?.cookies?.get({ name: STORAGE_KEY.SCRAPPER_SECRET_CODE, url: mainDomain }, (cookie) => {\r\n      chrome.tabs.sendMessage(tab?.id, { name: MESSAGE_NAME.SECRET_CODE_RECEIVED_FROM_COOKIE, payload: { cookie } }).catch(() => {});\r\n    });\r\n  });\r\n}\r\n\r\nconst linkedInLogin = (currentTabId: number) => {\r\n  const LINKEDIN_APP_LOGIN_URL = LINKED_LOGIN_CONFIG.LOGIN_URL;\r\n  const LINKEDIN_APP_CLIENT_ID = LINKED_LOGIN_CONFIG.APP_CLIENT_ID;\r\n  const REDIRECT_URL = chrome.identity.getRedirectURL() + LINKED_LOGIN_CONFIG.REDIRECT_URL;\r\n  const LINKEDIN_APP_SCOPE = LINKED_LOGIN_CONFIG.SCOPES;\r\n  chrome.identity.launchWebAuthFlow(\r\n    {\r\n      url: `${LINKEDIN_APP_LOGIN_URL}&client_id=${LINKEDIN_APP_CLIENT_ID}&redirect_uri=${REDIRECT_URL}&scope=${LINKEDIN_APP_SCOPE}`,\r\n      interactive: true\r\n    },\r\n    async (redirectUrl: any) => {\r\n      try {\r\n        const url = new URL(redirectUrl);\r\n        const searchParams = new URLSearchParams(url.search);\r\n        const code = searchParams.get('code');\r\n        if (code) {\r\n          postData(`${backendUrl}/user/signup`, code, REDIRECT_URL, {}).then((data) => {\r\n            const scraper_code = data?.user?.scraper_code || '';\r\n            setCookie(STORAGE_KEY.SCRAPPER_SECRET_CODE, scraper_code, () => {\r\n              postCookiesToContentScript();\r\n            });\r\n          });\r\n        }\r\n      } catch (e) {\r\n        console.log('Error while linkedin login:', e)\r\n      }\r\n    }\r\n  );\r\n}\r\n\r\nchrome?.runtime?.onMessage?.addListener?.((msg: Message) => {\r\n  const { payload } = msg;\r\n  if (msg.name === MESSAGE_NAME.SET_SECRET_CODE_IN_COOKIE) {\r\n    setCookie(STORAGE_KEY.SCRAPPER_SECRET_CODE, payload.token, () => {\r\n      postCookiesToContentScript();\r\n    });\r\n  } else if (msg.name === MESSAGE_NAME.GET_SECRET_CODE_FROM_COOKIE) {\r\n    postCookiesToContentScript();\r\n  } else if (msg.name === MESSAGE_NAME.LOGIN_WITH_LINKEDIN_REQUEST) {\r\n    linkedInLogin(payload.currentTabId);\r\n  }\r\n});\r\n\r\nconst insertPlugin = async (tabId: number) => {\r\n  await chrome.tabs.query({active: true, currentWindow: true}, (tabs) => {\r\n    const tab = tabs?.[0];\r\n    if (tab?.id && tab?.url?.includes('linkedin.com')) {\r\n      chrome.tabs.sendMessage(tab?.id, { name: MESSAGE_NAME.INSERT_SCRAPPER_PLUGIN, payload: { currentTabId: tabId } }).catch(() => {});\r\n    }\r\n  });\r\n}\r\n  \r\nchrome?.tabs?.onUpdated?.addListener((tabId, changeInfo, tab) => {\r\n  if (changeInfo.status == 'complete' && tab.status == 'complete' && tab.url != undefined) {\r\n    insertPlugin(tabId);\r\n  }\r\n});\r\n\r\n// chrome?.tabs?.onActivated?.addListener((activeInfo) => {\r\n//   const { tabId } = activeInfo;\r\n//   insertPlugin(tabId);\r\n// });"],"names":["mainDomain","LINKED_LOGIN_CONFIG","backendUrl","STORAGE_KEY","MESSAGE_NAME","postData","url","code","redirect_url","data","setCookie","name","value","callback","_a","postCookiesToContentScript","tabs","tab","cookie","linkedInLogin","currentTabId","LINKEDIN_APP_LOGIN_URL","LINKEDIN_APP_CLIENT_ID","REDIRECT_URL","LINKEDIN_APP_SCOPE","redirectUrl","scraper_code","e","_b","_c","msg","payload","insertPlugin","tabId","changeInfo"],"mappings":"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"}